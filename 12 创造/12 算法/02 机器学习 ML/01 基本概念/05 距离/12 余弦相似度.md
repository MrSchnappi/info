---
title: 12 余弦相似度
toc: true
date: 2019-08-28
---

# 余弦相似度

余弦相似度

## 余弦夹角

通过计算两个向量的夹角余弦值来评估它们的相似度。


$$
\cos (\theta)=\frac{A \cdot B}{\|A\|\|B\|}=\frac{\sum_{i=1}^{n} A_{i} \times B_{i}}{\sqrt{\sum_{i=1}^{n}\left(A_{i}\right)^{2} \times \sqrt{\sum_{i=1}^{n}\left(B_{i}\right)^{2}}}}
$$

余弦值的范围在 $[-1,1]$ 之间。


值越趋近于 $1$，代表两个向量的方向越趋近于 $0$，它们的方向更加一致。相应的相似度也越高。


## 意义

余弦相似性通过测量两个向量的夹角的余弦值来度量它们之间的相似性。

- 0度角的余弦值是 1
- 而其他任何角度的余弦值都不大于 1
- 最小值是-1。

从而两个向量之间的角度的余弦值确定两个向量是否大致指向相同的方向：

- 两个向量有相同的指向时，余弦相似度的值为 1；
- 两个向量夹角为 90°时，余弦相似度的值为 0；
- 两个向量指向完全相反的方向时，余弦相似度的值为-1。

这结果是与向量的长度无关的，仅仅与向量的指向方向相关。余弦相似度通常用于正空间，因此给出的值为 0 到 1 之间。

<span style="color:red;">什么是正空间。</span>

注意这上下界对任何维度的向量空间中都适用，而且余弦相似性最常用于高维正空间。例如在信息检索中，每个词项被赋予不同的维度，而一个文档由一个向量表示，其各个维度上的值对应于该词项在文档中出现的频率。余弦相似度因此可以给出两篇文档在其主题方面的相似度。

另外，它通常用于文本挖掘中的文件比较。此外，在数据挖掘领域中，会用到它来度量集群内部的凝聚力。

在信息检索的情况下，由于一个词的频率（TF-IDF权）不能为负数，所以这两个文档的余弦相似性范围从 0 到 1。并且，两个词的频率向量之间的角度不能大于 90°。






## 余弦相似与欧氏距离的区别和联系

### 区别

假设 2人对三部电影的评分分别是 `A = [3, 3, 3]` 和 `B = [5, 5, 5]`

那么 2 人的欧式距离是 根号 12 = 3.46， A、B的余弦相似度是 1（方向完全一致）。

> 余弦值的范围是[-1, 1], 越接近于 1，说明 2 个向量的方向越相近

欧式距离和余弦相似度都能度量 2 个向量之间的相似度，但是欧式距离从 2 点之间的距离去考量，余弦相似从 2 个向量之间的夹角去考量。
从上例可以发出，2人对三部电影的评价趋势是一致的，但是欧式距离并不能反映出这一点，余弦相似则能够很好地反应。余弦相似可以很好地规避指标刻度的差异，最常见的应用是计算 **文本的相似度** 。

### 联系

从下图的公式可以看出，归一化后计算的欧式距离是关于余弦相似的单调函数，可以认为归一化后，余弦相似与欧式距离效果是一致的（欧式距离越小等价于余弦相似度越大）。

因此可以将 **求余弦相似转为求欧式距离** ，余弦相似的计算复杂度过高，转为求欧式距离后，可以借助`KDTree`（KNN算法用到）或者`BallTree`（对高维向量友好）来降低复杂度。


<center>

![mark](http://images.iterate.site/blog/image/20190915/V8fhcG2Xirl5.png?imageslim)

</center>

> 余弦相似








# 相关

- [迁移学习简明手册](https://github.com/jindongwang/transferlearning-tutorial)  [王晋东](https://zhuanlan.zhihu.com/p/35352154)
- wiki
- [知乎：欧氏距离和余弦相似度的区别是什么？](https://www.zhihu.com/question/19640394)
