---
title: 07 用于结构化或序列输出的玻尔兹曼机
toc: true
date: 2019-06-05
---

# 用于结构化或序列输出的玻尔兹曼机


在结构化输出场景中，我们希望训练可以从一些输入 $\boldsymbol x$ 映射到一些输出 $\boldsymbol y$ 的模型，$\boldsymbol y$ 的不同条目彼此相关，并且必须遵守一些约束。例如，在语音合成任务中，$\boldsymbol y$ 是波形，并且整个波形听起来必须像连贯的发音。

表示 $\boldsymbol y$ 中的条目之间关系的自然方式是使用概率分布 $p(\mathbf y  \mid  \boldsymbol x)$。扩展到建模条件分布的玻尔兹曼机可以支持这种概率模型。

使用玻尔兹曼机条件建模的相同工具不仅可以用于结构化输出任务，还可以用于序列建模。在后一种情况下，模型必须估计变量序列上的概率分布 $p(\mathbf x^{(1)}, \dots, \mathbf x^{(\tau)})$，而不仅仅是将输入 $\boldsymbol x$ 映射到输出 $\boldsymbol y$。为完成这个任务，条件玻尔兹曼机可以表示 $p(\mathbf x^{(\tau)}  \mid  \mathbf x^{(1)}, \dots, \mathbf x^{(\tau-1)})$ 形式的因子。

视频游戏和电影工业中一个重要序列建模任务是建模用于渲染 3-D人物骨架关节角度的序列。这些序列通常通过记录角色移动的运动捕获系统收集。人物运动的概率模型允许生成新的（之前没见过的）但真实的动画。为了解决这个序列建模任务，{Taylor+2007} 针对小的 $m$ 引入了条件 RBM 建模 $p(\boldsymbol x^{(t)}  \mid  \boldsymbol x^{(t-1)}, \dots, \boldsymbol x^{(t-m)})$。该模型是 $p(\boldsymbol x^{(t)})$ 上的 RBM，其偏置参数是 $\boldsymbol x$ 前面 $m$ 个值的线性函数。当我们条件于 $\boldsymbol x^{(t-1)}$ 的不同值和更早的变量时， 我们会得到一个关于 $\mathbf x$ 的新 RBM。RBM 关于 $\mathbf x$ 的权重不会改变，但是条件于不同的过去值， 我们可以改变 RBM 中的不同隐藏单元处于活动状态的概率。通过激活和去激活隐藏单元的不同子集，我们可以对 $\mathbf x$ 上诱导的概率分布进行大的改变。条件 RBM 的其他变体  和使用条件 RBM 进行序列建模的其他变体是可能的 。

另一个序列建模任务是对构成歌曲音符序列的分布进行建模。{Boulanger-et-al-ICML2012} 引入了 **RNN-RBM**序列模型并应用于这个任务。RNN-RBM 由 RNN（产生用于每个时间步的 RBM 参数）组成，是帧序列 $\boldsymbol x^{(t)}$ 的生成模型。与之前只有 RBM 的偏置参数会在一个时间步到下一个发生变化的方法不同，RNN-RBM使用 RNN 来产生 RBM 的所有参数（包括权重）。为了训练模型，我们需要能够通过 RNN 反向传播损失函数的梯度。损失函数不直接应用于 RNN 输出。相反，它应用于 RBM。这意味着我们必须使用对比散度或相关算法关于 RBM 参数进行近似的微分。然后才可以使用通常的通过时间反向传播算法通过 RNN 反向传播该近似梯度。




# 相关

- 《深度学习》花书
