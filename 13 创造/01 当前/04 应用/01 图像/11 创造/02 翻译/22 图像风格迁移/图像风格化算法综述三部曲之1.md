---
title: 图像风格化算法综述三部曲之1
toc: true
date: 2019-11-17
---


## **前言**

**简介—前传—起源—发展—应用**的顺序依次对相关内容进行介绍。

## **1. 简介**

首先，第一个问题，什么是图像风格化(Neural Style Transfer)？简单来讲，图像风格化是将一张照片渲染成有艺术风格的画作。图像风格化算法的输入有二，分别是内容图和风格图，输出有一个，为风格迁移后的结果图。举个例子：

![img](https://pic3.zhimg.com/80/v2-2c42963322d402dd6dcb2cce65e4ff0e_hd.jpg)

上面这张表示图像风格化算法将输入的一张长城的照片作为内容图，将富春山居图作为风格图，将长城的内容保留，风格替换成中国山水画的风格，创作出一张新的艺术作品。

ok，基本的概念有了，下面我们来唠一唠风格化前传。

## **2. 前传**

图像风格化算法说白了其实就是一个图像渲染的过程。看到上面长城那张图，第一反应，图形学的一大分支——**非真实感图形学**，不也是干这件事的嘛。没错，大体来说，在非真实感图形学领域，图像艺术风格渲染技术可以大体分为基于笔触渲染的方法(Stroke-based Rendering)、基于图像类比的方法(Image Analogy)、基于图像滤波的方法(Image Filtering)。但为啥这些基于图形学的技术没有大规模落地，出现Prisma，Ostagram之类风靡全球的应用呢？咱们一个一个分析一下。首先，基于笔触渲染的方法，他在算法设计的之前首先会确定某一种风格，也就是说每一个基于笔触渲染的方法一般只对应于一种风格，而不能简单地扩展到其他风格的迁移；图像类比方法需要很多成对儿的原图和风格结果图作为训练集，然而对所有风格图找到这些成对儿的数据集貌似不太现实；而通过图像滤波的方法速度快、效果稳定，可满足工业界落地的需求(之前很火的时光相册出的“你的名字”滤镜估计就是算法工程师用这种方式不断调整出来的)，但是基于图像滤波的方法能模拟出来的风格种类很有限。

而在基于统计学的计算机视觉领域，图像艺术风格迁移也有很多大牛前辈研究过了。在视觉领域，图像艺术风格渲染一般被认为是**纹理合成**的一个扩展问题。纹理合成是给定一个源纹理图，然后去合成更多的类似的纹理结构，最终组成一个大的纹理图（关于纹理合成的相关工作这里就不详细说了，有兴趣的同学可以去看这个[博客](https://link.zhihu.com/?target=http%3A//www.cnblogs.com/dongdu/p/5073561.html)）。风格迁移中的风格图其实可以看成是一种纹理，由此，假如我们在合成纹理图的时候去刻意保留一些语义信息，那不就是风格迁移的结果嘛~ 没错，但那个年代管这个问题不叫风格迁移，而叫**纹理迁移(texture transfer)**，换汤不换药，意思是差不多的。但是呢，为啥纹理迁移在那会儿没有流行起来呢？因为那会儿纹理迁移是基于低层次的图像特征来做的，没有考虑语义信息，所以很多结果不那么得尽如人意。

是时候祭出下面这张图了（*图的下半部分有关Neural Style Transfer算法的分类会在下一篇文章具体讲述*）：

![img](https://pic3.zhimg.com/80/v2-b984b631e0a0782ba79ae13492df2126_hd.jpg)

## **3. 起源**

由前传中的介绍，我们可以发现现有的图像艺术风格渲染方法照着大规模落地还有一段距离。而正好在这个时代，有着很多前人所做的扎实的基础研究。很多新的研究都是站在巨人的肩膀上开拓和完成的，Neural Style Transfer也不例外。

譬如咱们说**纹理建模方法(Visual Texture Modelling)**，主要研究如何表示一种纹理，是纹理合成技术的核心。以往的纹理合成方法可以分为两大类：**基于统计分布的参数化纹理建模方法（Parametric Texture Modelling with Summary Statistics）**和 **基于MRF的非参数化纹理建模方法（Non-parametric Texture Modelling with MRFs）**。基于统计分布的参数化方法主要将纹理建模为N阶统计量，而基于MRF的方法一个经典套路是用patch相似度匹配进行逐点合成。而咱们之前提到过，风格可以看成一种纹理。咦那我们能不能直接把纹理建模这一套方法用于风格图中的风格建模？bingo，这就是图像风格化迁移算法(Neural Style Transfer)的起源和基石之一(到后面风格化发展章节中的现有风格化算法分类时大家对此会有更深的体会)。纹理建模方法的相关研究解决了图像风格化迁移的第一个大问题：如何对风格图中的风格特征进行建模和提取。

![img](https://pic3.zhimg.com/80/v2-9459de357eed0810b2a5202d40f2c032_hd.jpg)Image credited to Kaijian Gao from Brown University

好了，成功把风格图中的风格抽出来后，如何和内容混合然后还原成一个相应的风格化结果呢？这就到了另一个领域——**图像重建(Image Reconstruction)**了。图像重建的输入是特征表达，输出是特征表达对应的图像。他其实和咱们通常的输入图像提特征的过程相反，是把某个特征逆向重建为原来的图像(重建结果不唯一)。那这有啥用呢？以往图像重建主要是用来理解某些特征表达的。就比如说CNN特征，CNN是黑盒子，某个CNN特征具体包含哪些特征，这谁也不敢下定论。然后图像重建提供了一个可以加深特征理解的途径。假如说给定一张猴子的某个图像分类特征，我们重建出来的不同结果中猴子的五官位置均正确保留，而其他的比如颜色等不同结果不太一样，那么我们可以理解成此分类网络在分类猴子这个类别的图像的时候，会参考五官的位置来与其他类别进行区分。下面附上我两年前在课题组讲seminar时候画的一张图以帮助大家理解：

![img](https://pic2.zhimg.com/80/v2-1af1ab49257d807f9cdfe396871e0839_hd.jpg)

而通过重建预训练的分类网络(如VGG)中的高层特征，发现重建结果保留了_*高层语义信息_*而摒弃了低层的颜色等信息。此时此刻，结合咱们刚说的_*风格建模_*，拍脑门一想，假如我在图像重建时候加上个保留给定风格信息的约束，那不就可以让重建出的结果既有我们想要的内容图的_*高层语义信息_*，又有给定风格图中包含的_*风格信息_*吗？一个崭新的领域——**图像风格化迁移(Neural Style Transfer)**由此诞生。围绕图像风格化迁移技术，学术界和工业界风起云涌，英雄倍出。

![img](https://pic3.zhimg.com/80/v2-94c2603c78fd73fbf7a10349dea4744a_hd.jpg)



# 相关

- [图像风格化算法综述三部曲之 (一) (Neural Style Transfer: A Review)](https://zhuanlan.zhihu.com/p/36238178)
