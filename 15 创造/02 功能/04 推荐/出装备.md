推荐系统

信息技术部门中机器学习的主要应用之一是向潜在用户或客户推荐项目。这可以分为两种主要的应用：在线广告和项目建议(通常这些建议的目的仍然是为了销售产品)。两者都依赖于预测用户和项目之间的关联，一旦向该用户展示了广告或推荐了该产品，推荐系统要么预测一些行为的概率(用户购买产品或该行为的一些代替)或预期增益(其可取决于产品的价值)。目前，互联网的资金主要来自各种形式的在线广告。经济的主要部分依靠网上购物。包括 Amazon 和 eBay 在内的公司都使用了机器学习(包括深度学习)推荐他们的产品。有时，项目不是实际出售的产品，如选择在社交网络新闻信息流上显示的帖子、推荐观看的电影、推荐笑话、推荐专家建议、匹配视频游戏的玩家或匹配约会的人。

通常，这种关联问题可以作为监督学习问题来处理：给出一些关于项目和关于用户的信息，预测感兴趣的行为(用户点击广告、输入评级、点击“喜欢”按钮、购买产品，在产品上花钱、花时间访问产品页面等)。通常这最终会归结到回归问题(预测一些条件期望值)或概率分类问题(预测一些离散事件的条件概率)。

早期推荐系统的工作依赖于这些预测输入的最小信息：用户 ID 和项目 ID。在这种情况下，唯一的泛化方式依赖于不同用户或不同项目的目标变量值之间的模式相似性。假设用户 1 和用户 2 都喜欢项目 A，B和 C。由此，我们可以推断出用户 1 和用户 2 具有类似的口味。如果用户 1 喜欢项目 D，那么这可以强烈提示用户 2 也喜欢 D。基于此原理的算法称为协同过滤(collaborative filtering)。<span style="color:red;">嗯。</span>非参数方法(例如基于估计偏好模式之间相似性的最近邻方法)和参数方法都可能用来解决这个问题。参数方法通常依赖于为每个用户和每个项目学习分布式表示(也称为嵌入)。<span style="color:red;">为什么叫做嵌入呢？嵌入这个词哪来的？</span>目标变量的双线性预测(例如评级)是一种简单的参数方法，这种方法非常成功，通常被认为是最先进系统的组成部分。通过用户嵌入和项目嵌入之间的点积(可能需要使用仅依赖于用户 ID 或项目 ID 的常数来校正)获得预测。令 $\hat{\boldsymbol{R}}$ 是包含我们预测的矩阵，$\boldsymbol{A}$ 矩阵行中是用户嵌入，$\boldsymbol{B}$ 矩阵列中具有项目嵌入。令 $\boldsymbol{b}$ 和 $\boldsymbol{c}$ 是分别包含针对每个用户(表示用户平常坏脾气或积极的程度)以及每个项目(表示其大体受欢迎程度)的偏置向量。因此，双线性预测如下获得：

$$
\hat{R}_{u, i}=b_{u}+c_{i}+\sum_{j} A_{u, j} B_{j, i\cdot}\tag{12.20}
$$

通常，人们希望最小化预测评级 $\hat{R}_{u, i}$ 和实际评级 $R_{u, i}$ 之间的平方误差。当用户嵌入和项目嵌入首次缩小到低维度(两个或三个)时，它们就可以方便地可视化，或者可以将用户或项目彼此进行比较(就像词嵌入)。获得这些嵌入的一种方式是对实际目标(例如评级)的矩阵 $\boldsymbol{R}$ 进行奇异值分解。这对应于将 $\boldsymbol{R}=\boldsymbol{U} \boldsymbol{D} \boldsymbol{V}^{\prime}$ (或归一化的变体)分解为两个因子的乘积，低秩矩阵 $\boldsymbol{A}=\boldsymbol{U} \boldsymbol{D}$ 和 $\boldsymbol{B}=\boldsymbol{V}^{\prime}$。SVD的一个问题是它以任意方式处理缺失条目，如同它们对应于目标值 0。相反，我们希望避免为缺失条目做出的预测付出任何代价。幸运的是，观察到的评级的平方误差总和也可以使用基于梯度的优化最小化。SVD和式(12.20)中的双线性预测在 Netflix 奖竞赛中(目的是仅基于大量匿名用户的之前评级预测电影的评级)表现得非常好(Bennett and Lanning,2007)。许多机器学习专家参加了 2006 年和 2009 年之间的这场比赛。它提高了使用先进机器学习的推荐系统的研究水平，并改进了推荐系统。即使简单的双线性预测或 SVD 本身并没有赢得比赛，但它是大多数竞争对手提出的整体模型中一个组成部分，包括胜者(T-scher et al.,2009;Koren,2009)。

除了这些具有分布式表示的双线性模型之外，第一次用于协同过滤的神经网络之一是基于 RBM 的无向概率模型(Salakhutdinov et al.,2007)。RBM是 Netflix 比赛获胜方法的一个重要组成部分(T-scher et al.,2009;Koren,2009)。神经网络社群中也已经探索了对评级矩阵进行因子分解的更高级变体(Salakhutdinov and Mnih,2008)。<span style="color:red;">什么更高级变体？</span>

然而，协同过滤系统有一个基本限制：当引入新项目或新用户时，缺乏评级历史意味着无法评估其与其他项目或用户的相似性，或者说无法评估新的用户和现有项目的联系。这被称为冷启动推荐问题。解决冷启动推荐问题的一般方式是引入单个用户和项目的额外信息。例如，该额外信息可以是用户简要信息或每个项目的特征。使用这种信息的系统被称为基于内容的推荐系统(content-based recommender system)。<span style="color:red;">嗯。</span>从丰富的用户特征或项目特征集到嵌入的映射可以通过深度学习架构学习(Huang et al.,2013;Elkahky et al.,2015)。<span style="color:red;">还有这个名词吗？</span>

专用的深度学习架构，如卷积网络已经应用于从丰富内容中提取特征，如提取用于音乐推荐的音乐音轨(vanden O-rd et al.,2013)。在该工作中，卷积网络将声学特征作为输入并计算相关歌曲的嵌入。该歌曲嵌入和用户嵌入之间的点积则可以预测用户是否将收听该歌曲。<span style="color:red;">嗯，是的。</span>
