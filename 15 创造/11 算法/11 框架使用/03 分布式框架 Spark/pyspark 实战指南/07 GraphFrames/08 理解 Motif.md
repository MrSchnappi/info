---
title: 08 理解 Motif
toc: true
date: 2019-07-02
---
7.8 理解 Motif
为了更容易理解城市机场和航班之间的复杂关系，我们使用 motifs 命令进一步挖掘机场（例如节点）和航班（也就是边）之间的关系。DataFrame结果中的列名通过 Motif key给出。请注意，Motif查找是作为 GraphFrames 的一部分被支持的新图形算法之一。
例如，我们来确定由旧金山国际机场（SFO）造成的延误：
分解前面的查询，（x）表示节点（即机场），而[xy]表示边（即机场之间的航班）。因此，为了确定 SFO 造成的延误，可以使用以下定义：
·顶点（b）表示中间的机场（即 SFO）；
·顶点（a）表示出发地机场（数据集内）；
·顶点（c）表示目的地机场（数据集内）；
·边[ab]表示（a）（即出发地）和（b）（即 SFO）之间的航班；
·边[bc]表示（b）（即 SFO）和（c）（即目的地）之间的航班。
在 filter 命令的声明中，我们提供了一些基本的约束（注意，这只是一个简单的航班路径表示）：
·b.id＝'SFO'表示中间节点（b）仅限于 SFO 机场；
·（ab.delay>500 or bc.delay>500）表示我们仅限于延误大于 500 分钟的航班；
·（bc.tripid>ab.tripid and bc.tripid< li＝"">
此查询的输出如下图所示：
以下是此查询中简化的简化子集，其中列是相应的 Motif key：
观察 TUS>SFO>JFK的航班，你会注意到，从 Tuscon 到旧金山的航班提前了 5 分钟，从旧金山飞往纽约 JFK 机场的航班延误了 536 分钟。
通过使用 Motif 查找，你可以轻松搜索图形中的结构模式。通过 GraphFrames，你可以使用 DataFrame 的强大功能和速度来分发和执行查询。
