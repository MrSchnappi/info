---
title: 11 使用广度优先搜索
toc: true
date: 2019-07-02
---
7.11 使用广度优先搜索
广度优先搜索（BFS）是一种新的算法，它作为 GraphFrames 的一部分，可以找出从一组节点到另一组节点的最短路径。在本节中，我们将使用 BFS 遍历 tripGraph 命令来快速找到所需的节点（即机场）和边（即航班）。让我们来尝试根据数据集找到城市之间最短的连接数。请注意，这些例子不考虑时间或距离，只是在城市之间跳来跳去。例如，要查找西雅图和旧金山之间的直达航班数量，你可以运行以下查询：
fromExpr和 toExpr 是表示出发地和目的地机场（分别是 SEA 和 SFO）的表达式。maxPathLength＝1表示我们只需要两个节点之间的一个边，即西雅图和旧金山之间的直飞航班。如以下结果所示，西雅图和旧金山有很多直飞航班：
但是，如果我们想确定旧金山和布法罗之间的直飞航班数量呢？你会注意到运行以下查询将没有结果，也就是说，两个城市之间没有直飞航班：
一旦我们将前面的查询修改为 maxPathLength＝2，也就是一次中转，那么你将会看到更多的航班选项：
下表提供了此查询输出的一个简化版本：
但是现在我有我的机场列表，那我该如何确定哪些在 SFO 和 BUF 之间的中转机场更受欢迎呢？要确定这一点，您现在可以运行以下查询：
下面的条形图给出了输出：
