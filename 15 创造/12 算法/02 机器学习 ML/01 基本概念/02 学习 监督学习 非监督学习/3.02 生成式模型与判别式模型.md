---
title: 3.02 生成式模型与判别式模型
toc: true
date: 2019-04-06
---
# 可以补充进来的

- 感觉还有很多可以补充进来的以及理解的。

# 生成式模型与判别式模型


准确区分开生成式模型和判别式模型并不是一件非常容易的事情


## 判别模型

判别模型分为两种：

1. 直接对输入空间到输出空间的映射进行建模，也就是学习函数 $h$：

$$
h : X \rightarrow Y, s . t . y=h(x)
$$


2. 对条件概率 $P(y | x)$ 进行建模，然后根据贝叶斯风险最小化的准则进行分类：

$$
y=\underset{y \in[1-1]}{\arg \max } P(y | x)
$$

判别模型有如下：

- 感知机
- 逻辑斯特回归
- 支持向量机
- 神经网络
- K 近邻


## 生成模型

生成模型是间接地，先对 $P(x, y)$ 进行建模，再根据贝叶斯公式：

$$
P(y | x)=\frac{P(x | y) P(y)}{P(x)}
$$


算出 $\mathrm{P}(\mathrm{y} | \mathrm{x})$ ，最后根据 $y=\underset{y \in\{1,-1\}}{\arg \max } P(y | x)$ 来做分类 (由 $y=\underset{y \in\{1,-1\}}{\arg \max } P(y | x)$ 可知，实际上不需要对 $P(x)$ 进行建模)。

对于分类问题，实际上我们只需对 $P(y | x)$ 直接进行建模就行了，没必要间接地先对 $P(x, y)$ 进行建模。但是对 $P(x, y)$ 进行建模从而达到判别的目的也有它自身的一些优势。<span style="color:red;">什么优势？</span>


生成模型有如下：

- 高斯判别分析
- 朴素贝叶斯



## 生成式模型和判别式模型的区别

<span style="color:red;">没怎么特别清楚，感觉是这样，但是不是很明白。</span>

假设可观测到的变量集合为 $X$，需要预测的变量集合为 $Y$，其他的变量集合为 $Z$ 。

生成式模型是对联合概率分布 $P(X, Y, Z)$ 进行建模，在给定观测集合 $X$ 的条件下，通过计算边缘分布来得到对变量集合 Y 的推断，即：

$$
P(Y | X)=\frac{P(X, Y)}{P(X)}=\frac{\sum_{Z} P(X, Y, Z)}{\sum_{Y, Z} P(X, Y, Z)}\tag{6.20}
$$

判别式模型是直接对条件概率分布 $P(Y, Z | X)$ 进行建模，然后消掉无关变量 $Z$ 就可以得到对变量集合 Y 的预测，即：

$$
P(Y | X)=\sum_{Z} P(Y, Z | X)\tag{6.21}
$$



## 生成式模型、判别式模型的区别？

对于机器学习模型，我们可以根据模型对数据的建模方式将模型分为两大类，生成式模型和判别式模型。

如果我们要训练一个关于猫狗分类的模型，对于判别式模型，只需要学习二者差异即可。比如说猫的体型会比狗小一点。而生成式模型则不一样，需要学习猫张什么样，狗张什么样。有了二者的长相以后，再根据长相去区分。具体而言：

- 生成式模型：由数据学习联合概率分布 $P(X,Y)$, 然后由 $P(Y|X)=P(X,Y)/P(X)$ 求出概率分布 $P(Y|X)$ 作为预测的模型。该方法表示了给定输入 $X$ 与产生输出 $Y$ 的生成关系
- 判别式模型：由数据直接学习决策函数 $Y=f(X)$ 或条件概率分布 $P(Y|X)$ 作为预测模型，即判别模型。判别方法关心的是对于给定的输入 $X$，应该预测什么样的输出 $Y$。

<span style="color:red;">没有很理解。</span>

对于上述两种模型，从文字上理解起来似乎不太直观。我们举个例子来阐述一下，对于性别分类问题，分别用不同的模型来做：

1）如果用生成式模型：可以训练一个模型，学习输入人的特征 $X$ 和性别 $Y$ 的关系。比如现在有下面一批数据：

| Y（性别） |     | 0   | 1   |
| --------- | --- | --- | --- |
| X（特征） | 0   | 1/4 | 3/4 |
|           | 1   | 3/4 | 1/4 |

这个数据可以统计得到，即统计人的特征 $X=0,1…$ 的时候，其类别为 $Y=0,1$ 的概率。统计得到上述联合概率分布 $P(X, Y)$ 后，可以学习一个模型，比如让二维高斯分布去拟合上述数据，<span style="color:red;">怎么拟合这样的数据的？</span>这样就学习到了 $X$，$Y$ 的联合分布。<span style="color:red;">输出的是一个概率值吗？</span>在预测时，如果我们希望给一个输入特征 $X$，预测其类别，则需要通过贝叶斯公式得到条件概率分布才能进行推断：<span style="color:red;">这个公式是做在网络里面的吗？还是对网络输出的结果输入到这个公式里面？$P(X|Y)$ 是怎么得到的？</span>

$$
P(Y|X)={\frac{P(X,Y)}{P(X)}}={\frac{P(X,Y)}{P(X|Y)P(Y)}}
$$

2）如果用判别式模型：可以训练一个模型，输入人的特征 $X$，这些特征包括人的五官，穿衣风格，发型等。输出则是对于性别的判断概率，这个概率服从一个分布，分布的取值只有两个，要么男，要么女，记这个分布为 $Y$。这个过程学习了一个条件概率分布 $P(Y|X)$，即输入特征 $X$ 的分布已知条件下，$Y$ 的概率分布。

<span style="color:red;">没有很明白，上面说的生成器模型和判别器模型的输出是什么？一个是概率值，一个是是否是男女吗？</span>

显然，从上面的分析可以看出。判别式模型似乎要方便很多，因为生成式模型要学习一个 $X$，$Y$ 的联合分布往往需要很多数据，而判别式模型需要的数据则相对少，因为判别式模型更关注输入特征的差异性。不过生成式既然使用了更多数据来生成联合分布，自然也能够提供更多的信息，现在有一个样本 $（X,Y）$，其联合概率 $P（X,Y）$ 经过计算特别小，那么可以认为这个样本是异常样本。这种模型可以用来做 outlier detection。<span style="color:red;">厉害呀。这个真的可以这样吗？</span>



## 常见的概率图模型中，哪些是生成式模型，哪些是判别式模型？

常见的概率图模型有：<span style="color:red;">要都总结进来。</span>

- 朴素贝叶斯
- 最大熵模型
- 贝叶斯网络
- 隐马尔可夫模型
- 条件随机场
- pLSA
- LDA
- 等

下面列出各模型所属及原因：<span style="color:red;">还是不清楚，要全部分析一遍。</span>

- 这些模型都是先对联合概率分布进行建模，然后再通过计算边缘分布得到对变量的预测，所以它们都属于**生成式模型**：
    - 朴素贝叶斯
    - 贝叶斯网络
    - pLSA
    - LDA
    - 等
- 最大熵模型是直接对条件概率分布进行建模
    - 最大熵模型是**判别式模型**
- 隐马尔可夫模型和条件随机场模型是对序列数据进行建模的方法
    - 隐马尔可夫模型属于**生成式模型**
    - 条件随机场属于**判别式模型**




# 相关

- 《百面机器学习》
- [监督学习的分类：判别模型与生成模型，概率模型与非概率模型、参数模型与非参数模型](https://zhuanlan.zhihu.com/p/26012348)
2348)
