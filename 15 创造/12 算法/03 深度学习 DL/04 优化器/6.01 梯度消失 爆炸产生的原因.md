---
title: 6.01 梯度消失 爆炸产生的原因
toc: true
date: 2019-09-04
---

# 梯度消失/爆炸产生的原因？

本质上，梯度消失和爆炸是一种情况。在深层网络中，由于网络过深，如果初始得到的梯度过小，或者传播途中在某一层上过小，则在之后的层上得到的梯度会越来越小，即产生了梯度消失。梯度爆炸也是同样的。一般地，不合理的初始化以及激活函数，如 sigmoid 等，都会导致梯度过大或者过小，从而引起消失/爆炸。

下面分别从网络深度角度以及激活函数角度进行解释：

（1）网络深度

若在网络很深时，若权重初始化较小，各层上的相乘得到的数值都会 0-1之间的小数，而激活函数梯度也是 0-1之间的数。那么连乘后，结果数值就会变得非常小，导致**梯度消失**。若权重初始化较大，大到乘以激活函数的导数都大于 1，那么连乘后，可能会导致求导的结果很大，形成**梯度爆炸**。

（2）激活函数
如果激活函数选择不合适，比如使用 sigmoid，梯度消失就会很明显了，原因看下图，左图是 sigmoid 的函数图，右边是其导数的图像，如果使用 sigmoid 作为损失函数，其梯度是不可能超过 0.25的，这样经过链式求导之后，很容易发生梯度消失。
<center>

![](http://images.iterate.site/blog/image/20190722/EPNd4hEggYRD.png？imageslim){ width=55% }

</center>


> 图 13.8.2 sigmod函数与其导数
