---
title: 43 精确推断-信念传播
toc: true
date: 2018-07-01 10:38:22
---
# 精确推断-信念传播


## 信念传播

亦称 Sum-Product 算法.


信念传播(Belief Propagation)算法将变量消去法中的求和操作看作一个消 息传递过程，较好地解决了求解多个边际分布时的重复计算问题。具体来说，变 量消去法通过求和操作

$$
m_{i j}\left(x_{j}\right)=\sum_{x_{i}} \psi\left(x_{i}, x_{j}\right) \prod_{k \in n(i) \backslash j} m_{k i}\left(x_{i}\right)
$$


消去变量 $x_i$，其中 $n(i)$ 表示结点 $x_i$ 的邻接结点。在信念传播算法中，这个操作 被看作从 $x_i$ 向 $x_j$ 传递了一个消息 $m_{ij}(x_j)$ 。这样，式(14.15)和(l4.16) 所描述的变量消去过程就能描述为图 14.7(b)所示的消息传递过程。不难发现，每次消息传递操作仅与变量及其邻接结点直接相关，换言之，消息传递相关的计算被限制在图的局部进行.



在信念传播算法中，一个结点仅在接收到来自其他所有结点的消息后才能 向另一个结点发送消息，且结点的边际分布正比于它所接收的消息的乘积，即

$$
P\left(x_{i}\right) \propto \prod_{k \in n(i)} m_{k i}\left(x_{i}\right)
$$

例如在图 14.7(b) 中，结点 $x_3$ 要向 $x_5$ 发送消息，必须事先收到来自结点 $x_2$ 和 $x_4$ 的消息，且传递到岛的消息 $m_{35}(x_5)$ 恰为概率 $P(x_5)$ .

若图结构中没有环，则信念传播算法经过两个步骤即可完成所有消息传递， 进而能计算所有变量上的边际分布：

- 指定一个根结点，从所有叶结点开始向根结点传递消息，直到根结点收到 所有邻接结点的消息；

- 从根结点开始向叶结点传递消息，直到所有叶结点均收到消息.

例如在图 14.7(a)中，令 $x_1$ 为根结点，则 $x_4$ 和 $x_5$ 为叶结点。以上两步消息传递的过程如图 14.8所示。此时图的每条边上都有方向不同的两条消息，基于这些消息和式(14.20)即可获得所有变量的边际概率.


<center>

![](http://images.iterate.site/blog/image/180701/gh8blEafL5.png?imageslim){ width=55% }

</center>




# 相关

- 《机器学习》周志华
